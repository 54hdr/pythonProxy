# Python正向代理服务器

本项目是一个使用Python标准库实现的HTTP正向代理服务器，支持在服务器部署后，本地Win10通过设置代理以服务器IP访问网络。

## 功能特性

- 使用Python标准库实现，无需额外依赖
- 支持HTTP请求的转发
- 支持命令行参数配置（主机和端口）
- 多线程处理，支持并发连接
- 基本的错误处理和日志记录

## 部署方法

### 在服务器上部署

1. **上传文件**
   将 `proxy_server.py` 文件上传到您的服务器上。

2. **启动服务器**
   ```bash
   # 默认监听所有网络接口，端口8080
   python proxy_server.py
   
   # 自定义监听地址和端口
   python proxy_server.py 0.0.0.0 8888
   ```

3. **后台运行（可选）**
   如果您希望服务器在后台运行，可以使用 `nohup` 或 `screen` 命令：
   ```bash
   # 使用nohup
   nohup python proxy_server.py > proxy.log 2>&1 &
   
   # 使用screen
   screen -S proxy
   python proxy_server.py
   # 按 Ctrl+A+D 分离会话
   ```

4. **防火墙设置**
   确保服务器防火墙允许访问您设置的代理端口（默认为8080）。

## 本地Win10设置代理

### 设置浏览器代理

#### Chrome浏览器
1. 打开Chrome浏览器
2. 点击右上角的三个点 → 设置 → 高级 → 系统
3. 点击「打开您计算机的代理设置」
4. 在「手动代理设置」部分，开启「使用代理服务器」
5. 在「地址」中输入服务器的IP地址
6. 在「端口」中输入代理服务器的端口（默认为8080）
7. 点击「保存」

#### Firefox浏览器
1. 打开Firefox浏览器
2. 点击右上角的三个横线 → 设置 → 常规
3. 滚动到底部，点击「网络设置」
4. 选择「手动配置代理」
5. 在「HTTP代理」中输入服务器的IP地址
6. 在「端口」中输入代理服务器的端口（默认为8080）
7. 勾选「为所有协议使用相同的代理」
8. 点击「确定」

### 全局代理设置

1. 打开「设置」→「网络和Internet」→「代理」
2. 在「手动代理设置」部分，开启「使用代理服务器」
3. 在「地址」中输入服务器的IP地址
4. 在「端口」中输入代理服务器的端口（默认为8080）
5. 点击「保存」

## 使用方法

1. 启动服务器后，服务器会输出类似以下信息：
   ```
   [INFO] 正向代理服务器已启动，监听地址: 0.0.0.0:8080
   [INFO] 本地Win10设置代理为: 0.0.0.0:8080
   ```

2. 在本地Win10设置代理为服务器的IP地址和端口

3. 打开浏览器访问任何网站，流量都会通过代理服务器转发

4. 服务器控制台会显示请求日志：
   ```
   [INFO] 接收到来自 192.168.1.100:12345 的连接
   [INFO] 192.168.1.100 请求: GET http://www.example.com/ HTTP/1.1
   ```

## 停止服务器

- 在服务器控制台按 `Ctrl+C` 停止服务器
- 如果是后台运行，可以使用 `kill` 命令停止进程

## 注意事项

1. **性能限制**：由于使用Python标准库和多线程实现，本代理服务器适合小型应用场景，不适合高并发生产环境。

2. **安全性**：本代理服务器未实现认证机制，请确保只在可信网络环境中使用，或自行添加认证功能。

3. **HTTPS支持**：本代理服务器仅支持HTTP协议，不支持HTTPS的中间人代理。对于HTTPS连接，浏览器会使用CONNECT方法建立隧道。

4. **防火墙**：确保服务器防火墙允许代理端口的访问。

5. **网络延迟**：使用代理服务器会增加网络延迟，这是正常现象。

## 命令行参数

```
python proxy_server.py [host] [port]
```

- `host`：监听地址，默认为 `0.0.0.0`（所有网络接口）
- `port`：监听端口，默认为 `8080`

## 常见问题

### 无法连接到代理服务器
- 检查服务器是否正在运行
- 检查服务器防火墙是否允许端口访问
- 检查本地网络是否可以访问服务器IP
- 检查代理设置是否正确

### 代理服务器运行缓慢
- 考虑使用更强大的服务器
- 减少并发连接数
- 检查网络带宽

### 某些网站无法访问
- 检查目标网站是否可从服务器访问
- 检查是否有DNS解析问题
- 检查目标网站是否有地域限制

## 扩展建议

如果您需要更高级的功能，可以考虑：

1. 添加认证机制（用户名/密码）
2. 支持HTTPS的中间人代理
3. 添加请求/响应过滤功能
4. 使用异步I/O提高性能
5. 添加缓存功能减少重复请求
